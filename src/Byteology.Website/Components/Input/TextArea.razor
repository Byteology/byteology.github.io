@using Microsoft.AspNetCore.Components.Forms

@inherits InputTextArea

<div @attributes=AdditionalAttributes class=@CssClass>
    <label for="@_id" class="font-bold text-sm">@Label</label>

    <div class="text-area-wrapper
                grid mt-2
                after:whitespace-pre-wrap after:invisible after:pl-4
                after:row-start-1 after:row-end-2 after:col-start-1 after:col-end-1
                after:text-sm
                after:border-b-2
                after:content-[attr(data-replicated-value)_'_']"
         data-replicated-value=@_value >

        <textarea 
            @bind="CurrentValueAsString"
            @bind:event="onchange"
            @oninput="onValueChanged"
            id="@_id"
            placeholder="@Placeholder"
            rows="1"
            class="
                resize-none overflow-hidden pl-4
                transition-fast
                row-start-1 row-end-2 col-start-1 col-end-1
                bg-transparent text-sm
                border-b-2 border-primary
                placeholder:italic placeholder:text-neutral-200
                hover:border-primary-300
                [.invalid_>.text-area-wrapper_>_&]:border-error
                focus:!border-primary-300" />

    </div>
</div>

@code {
    private readonly Guid _id = Guid.NewGuid();
    private string? _value;

    [Parameter]
    public string? Placeholder { get; set; }

    [Parameter]
    public string? Label { get; set; }

    private void onValueChanged(ChangeEventArgs e)
    {
        _value = (string?)e.Value;
    }
}